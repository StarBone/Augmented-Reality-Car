<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nissan</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <img id="logo" src="FairladyZ.svg" alt="" />

      <model-viewer
        id="model-viewer"
        src="nissan_fairlady_z_s30240z_1978.glb"
        ar
        ar-modes="webxr scene-viewer quick-look"
        camera-controls
        tone-mapping="neutral"
        poster="poster.webp"
        shadow-intensity="2"
        exposure="0.36"
        camera-orbit="402.2deg 85deg 5.15m"
        field-of-view="17.6deg"
        min-camera-orbit="auto 85deg 5.15m"
        max-camera-orbit="auto 85deg auto"
        min-field-of-view="17.6deg"
      >
        <div class="progress-bar hide" slot="progress-bar">
          <div class="update-bar"></div>
        </div>
      </model-viewer>

      <div class="color" id="color-controls">
        <button id="putih" data-color="#404040"></button>
        <button id="merah" data-color="#600000"></button>
        <button id="kuning" data-color="#b59700"></button>
      </div>
      <button id="ar-button" slot="ar-button">ðŸ‘‹ Activate AR</button>
    </div>
    <script
      type="module"
      src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"
    ></script>
    <script>
      const modelViewer = document.querySelector("#model-viewer");

      modelViewer.addEventListener("load", () => {
        const material = modelViewer.model.materials.find(
          (m) => m.name === "Material.001"
        );
        if (!material) {
          console.warn('Material "Material.001" tidak ditemukan.');
          return;
        }

        document
          .querySelector("#color-controls")
          .addEventListener("click", (event) => {
            const colorHex = event.target.dataset.color;
            if (!colorHex) return;

            const rgb = hexToRgbNormalized(colorHex);
            material.pbrMetallicRoughness.baseColorTexture = null; // Hapus tekstur kalau ada
            material.pbrMetallicRoughness.setBaseColorFactor([
              rgb.r,
              rgb.g,
              rgb.b,
              1,
            ]);
          });

        function hexToRgbNormalized(hex) {
          const bigint = parseInt(hex.replace("#", ""), 16);
          return {
            r: ((bigint >> 16) & 255) / 255,
            g: ((bigint >> 8) & 255) / 255,
            b: (bigint & 255) / 255,
          };
        }
      });
    </script>
  </body>
</html>
